name: Check Backend Files

on:
  workflow_dispatch:

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Check Backend Files
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          port: 22
          script: |
            echo "=== Current Git Commit ==="
            cd /var/www/hranitel
            git log -1 --oneline

            echo ""
            echo "=== Check energy-points/index.ts import ==="
            head -3 /var/www/hranitel/backend/src/modules/energy-points/index.ts

            echo ""
            echo "=== Check reports/service.ts import ==="
            head -10 /var/www/hranitel/backend/src/modules/reports/service.ts | grep energyPointsService

            echo ""
            echo "=== List node_modules ==="
            ls -la /var/www/hranitel/backend/node_modules/ | head -20
