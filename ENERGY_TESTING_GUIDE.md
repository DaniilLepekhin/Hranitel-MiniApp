# üß™ –ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å —Ç–µ—Å—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–π

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
2. [Backend —Ç–µ—Å—Ç—ã (Bun + Elysia.js)](#backend-—Ç–µ—Å—Ç—ã)
3. [Frontend —Ç–µ—Å—Ç—ã (–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)](#frontend-—Ç–µ—Å—Ç—ã)
4. [Database —Ç–µ—Å—Ç—ã (PostgreSQL)](#database-—Ç–µ—Å—Ç—ã)
5. [End-to-End —Ç–µ—Å—Ç—ã](#end-to-end-—Ç–µ—Å—Ç—ã)
6. [–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤](#–ø—Ä–æ–≤–µ—Ä–∫–∞-–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö-—Å–ª—É—á–∞–µ–≤)

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –¥–µ–ø–ª–æ–π –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ

**GitHub Actions:**
```bash
# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
https://github.com/DaniilLepekhin/Hranitel-MiniApp/actions

# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∫–æ–º–º–∏—Ç–∞ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ:
# - 8e99efd: fix: update energiesApi.getBalance calls to new signature
# - ae7767e: feat: add energy history modal to ratings tab
# - 988bbf6: fix: handle undefined transactions in energy history modal
# - 538a930: perf: optimize energy history loading performance
# - e24e2a4: perf: deeply optimize energy history modal performance
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å backend
curl https://app.successkod.com/health

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
# {"status":"ok"}
```

---

## Backend —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoint –¥–ª—è –±–∞–ª–∞–Ω—Å–∞

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/v1/energies/balance` —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ú–µ—Ç–æ–¥:**
```bash
# –í Postman –∏–ª–∏ curl
curl -X GET "https://app.successkod.com/api/v1/energies/balance" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json"

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "success": true,
  "balance": 120  # –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
}
```

**–ì–¥–µ –≤–∑—è—Ç—å JWT —Ç–æ–∫–µ–Ω:**
1. –û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –û—Ç–∫—Ä—ã—Ç—å DevTools (F12) ‚Üí Network
3. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
4. –ù–∞–π—Ç–∏ –ª—é–±–æ–π –∑–∞–ø—Ä–æ—Å –∫ API
5. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization`

---

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoint –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/v1/energies/history` —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ú–µ—Ç–æ–¥:**
```bash
curl -X GET "https://app.successkod.com/api/v1/energies/history?limit=10" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json"

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "success": true,
  "transactions": [
    {
      "id": "uuid",
      "userId": "user-id",
      "amount": 20,
      "type": "income",
      "reason": "–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞",
      "metadata": {
        "lessonId": "123"
      },
      "expiresAt": "2026-08-11T...",
      "isExpired": false,
      "createdAt": "2026-02-11T..."
    }
  ]
}
```

---

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `backend/src/modules/courses/index.ts`

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –∏ –Ω–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–∏ 268-285
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å –≤—ã–∑–æ–≤:
   ```typescript
   await energiesService.awardLessonView(userId, lessonId);
   ```
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—ã–∑–æ–≤ –æ–±—ë—Ä–Ω—É—Ç –≤ `try-catch` (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
cd backend
cat src/modules/courses/index.ts | grep -A 20 "energiesService.awardLessonView"
```

---

### –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–§–∞–π–ª:** `backend/src/modules/energy-points/service.ts`

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –∏ –Ω–∞–π—Ç–∏ –º–µ—Ç–æ–¥ `awardLessonView`
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞:
   ```typescript
   const existingAward = await db.query.energyTransactions.findFirst({
     where: and(
       eq(energyTransactions.userId, userId),
       sql`${energyTransactions.metadata}->>'lessonId' = ${lessonId}`
     ),
   });
   
   if (existingAward) {
     console.log(`[Energies] User ${userId} already received award for lesson ${lessonId}`);
     return { success: false, message: 'Already awarded' };
   }
   ```

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
cd backend
cat src/modules/energy-points/service.ts | grep -A 15 "awardLessonView"
```

---

## Frontend —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –±–∞–ª–∞–Ω—Å —ç–Ω–µ—Ä–≥–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å Mini App: https://t.me/hranitelkodbot/app
2. **–í–∫–ª–∞–¥–∫–∞ "–ì–ª–∞–≤–Ω–∞—è"** (Home):
   - –ù–∞–π—Ç–∏ –±–ª–æ–∫ "–ú–æ–π –±–∞–ª–∞–Ω—Å" (–∫—Ä–∞—Å–Ω—ã–π –±–ª–æ–∫)
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —á–∏—Å–ª–æ —ç–Ω–µ—Ä–≥–∏–π
   - –°–∫—Ä–∏–Ω—à–æ—Ç: ‚úÖ / ‚ùå
   
3. **–í–∫–ª–∞–¥–∫–∞ "–†–µ–π—Ç–∏–Ω–≥–∏"** (Ratings):
   - –ù–∞–π—Ç–∏ –±–ª–æ–∫ "–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å" (–∫—Ä–∞—Å–Ω—ã–π –±–ª–æ–∫ –≤–≤–µ—Ä—Ö—É)
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —á–∏—Å–ª–æ —ç–Ω–µ—Ä–≥–∏–π
   - –°–∫—Ä–∏–Ω—à–æ—Ç: ‚úÖ / ‚ùå

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ë–∞–ª–∞–Ω—Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –Ω–∞ –æ–±–µ–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö
- –ß–∏—Å–ª–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —ç–Ω–µ—Ä–≥–∏–π

---

### –¢–µ—Å—Ç 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π"

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –ª–∞–≥–æ–≤

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥–∏"
2. –ù–∞–π—Ç–∏ –±–ª–æ–∫ "–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å"
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π" (—Å –∏–∫–æ–Ω–∫–æ–π —á–∞—Å–æ–≤)
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–ª–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å—Å—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** (<100ms)
   - –ê–Ω–∏–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–ø–ª–∞–≤–Ω–æ–π** (60 FPS)
   - –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **—Ñ—Ä–∏–∑–æ–≤ UI**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û–∫–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ
- ‚úÖ –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ù–µ—Ç –ª–∞–≥–æ–≤ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏

**–ï—Å–ª–∏ –ª–∞–≥–∞–µ—Ç:**
- –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Performance
- –ó–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ—Ç –ª–∏ –¥–æ–ª–≥–∏—Ö –∑–∞–¥–∞—á (>50ms)

---

### –¢–µ—Å—Ç 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏—Å—Ç–æ—Ä–∏–∏

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π"
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é:**
   - ‚úÖ –ï—Å—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ ("–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞")
   - ‚úÖ –ï—Å—Ç—å –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è ("11 —Ñ–µ–≤—Ä. 2026 –≤ 14:30")
   - ‚úÖ –ï—Å—Ç—å —Å—É–º–º–∞ (+20 ‚ö°)
   - ‚úÖ –¶–≤–µ—Ç: –∑–µ–ª—ë–Ω—ã–π –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π, –∫—Ä–∞—Å–Ω—ã–π –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏–π
   - ‚úÖ –ï—Å–ª–∏ –µ—Å—Ç—å lessonId - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "–£—Ä–æ–∫ #123"
   - ‚úÖ –ï—Å–ª–∏ –µ—Å—Ç—å —Å—Ä–æ–∫ –∏—Å—Ç–µ—á–µ–Ω–∏—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∞—Ç–∞

**–ü—Ä–∏–º–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:**
```
–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞
11 —Ñ–µ–≤—Ä. 2026 –≤ 14:30
–£—Ä–æ–∫ #5
+20 ‚ö°
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò—Å—Ç–µ–∫–∞–µ—Ç: 11 –∞–≤–≥. 2026
```

---

### –¢–µ—Å—Ç 8: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤ –ë–î)
2. –û—Ç–∫—Ä—ã—Ç—å "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π"
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–∫–æ–Ω–∫–∞ —á–∞—Å–æ–≤
   - ‚úÖ –¢–µ–∫—Å—Ç: "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –ø–æ–∫–∞ –ø—É—Å—Ç–∞"
   - ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

---

## Database —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã energy_transactions

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
-- –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
psql -U postgres -d hranitel_db

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
\d energy_transactions

-- –û–∂–∏–¥–∞–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏:
-- id, user_id, amount, type, reason, metadata, expires_at, is_expired, created_at

-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
SELECT 
  id,
  user_id,
  amount,
  type,
  reason,
  metadata,
  created_at
FROM energy_transactions
ORDER BY created_at DESC
LIMIT 10;
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ –ï—Å—Ç—å –∑–∞–ø–∏—Å–∏ —Å `reason = '–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞'`
- ‚úÖ –í `metadata` –µ—Å—Ç—å `lessonId`
- ‚úÖ `amount = 20`
- ‚úÖ `type = 'income'`

---

### –¢–µ—Å—Ç 10: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞ –æ–¥–∏–Ω —É—Ä–æ–∫ –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
-- –ù–∞–π—Ç–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ lessonId –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT 
  user_id,
  metadata->>'lessonId' as lesson_id,
  COUNT(*) as count
FROM energy_transactions
WHERE type = 'income'
  AND reason = '–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞'
GROUP BY user_id, metadata->>'lessonId'
HAVING COUNT(*) > 1;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 —Å—Ç—Ä–æ–∫ (–Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- ‚úÖ –ó–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 —Å—Ç—Ä–æ–∫
- ‚úÖ –ï—Å–ª–∏ –µ—Å—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã - —ç—Ç–æ –±–∞–≥!

---

### –¢–µ—Å—Ç 11: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –±–∞–ª–∞–Ω—Å —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
-- –ó–∞–º–µ–Ω–∏—Ç—å 'YOUR_USER_ID' –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT 
  user_id,
  SUM(CASE WHEN type = 'income' THEN amount ELSE 0 END) as total_earned,
  SUM(CASE WHEN type = 'expense' THEN amount ELSE 0 END) as total_spent,
  SUM(CASE WHEN type = 'income' THEN amount ELSE -amount END) as balance
FROM energy_transactions
WHERE user_id = 'YOUR_USER_ID'
  AND (is_expired = false OR is_expired IS NULL)
GROUP BY user_id;
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- ‚úÖ `balance` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –±–∞–ª–∞–Ω—Å–æ–º –≤ UI
- ‚úÖ `total_earned` = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–∫–æ–≤ √ó 20
- ‚úÖ `total_spent` = 0 (–µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫—É–ø–∞–ª–∏)

---

### –¢–µ—Å—Ç 12: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–π

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `expires_at` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (6 –º–µ—Å—è—Ü–µ–≤)

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
SELECT 
  id,
  created_at,
  expires_at,
  EXTRACT(MONTH FROM (expires_at - created_at)) as months_diff
FROM energy_transactions
WHERE type = 'income'
  AND reason = '–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞'
ORDER BY created_at DESC
LIMIT 10;
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- ‚úÖ `months_diff` = 6 (6 –º–µ—Å—è—Ü–µ–≤)
- ‚úÖ `expires_at` –Ω–µ NULL

---

## End-to-End —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 13: –ü–æ–ª–Ω—ã–π —Ñ–ª–æ—É –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–π

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —É—Ä–æ–∫–∞ –¥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏–∏

**–®–∞–≥–∏:**

#### –®–∞–≥ 1: –ó–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å
```
–û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥–∏"
–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: ___ —ç–Ω–µ—Ä–≥–∏–π
```

#### –®–∞–≥ 2: –ü—Ä–æ–π—Ç–∏ –Ω–æ–≤—ã–π —É—Ä–æ–∫
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ö—É—Ä—Å—ã"
2. –í—ã–±—Ä–∞—Ç—å –ª—é–±–æ–π –∫—É—Ä—Å
3. –û—Ç–∫—Ä—ã—Ç—å —É—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π **–µ—â—ë –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏**
4. –î–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Ä–æ–∫ –¥–æ –∫–æ–Ω—Ü–∞
5. –ù–∞–∂–∞—Ç—å "–ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫" / "–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫"

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
1. –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥–∏"
2. **–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É** (–ø–æ—Ç—è–Ω—É—Ç—å –≤–Ω–∏–∑ –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–π—Ç–∏)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–°—Ç–∞—Ä—ã–π –±–∞–ª–∞–Ω—Å: X —ç–Ω–µ—Ä–≥–∏–π
–ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å: X + 20 —ç–Ω–µ—Ä–≥–∏–π
```

‚úÖ / ‚ùå

#### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
1. –ù–∞–∂–∞—Ç—å "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π"
2. **–ü–µ—Ä–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ —Å–ø–∏—Å–∫–µ** –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–æ–≤–æ–π:
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞"
   - –°—É–º–º–∞: +20 ‚ö°
   - –í—Ä–µ–º—è: —Ç–æ–ª—å–∫–æ —á—Ç–æ (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥/–º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥)
   - –£—Ä–æ–∫: #XXX (ID —É—Ä–æ–∫–∞)

‚úÖ / ‚ùå

---

### –¢–µ—Å—Ç 14: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞ –æ–¥–∏–Ω —É—Ä–æ–∫ –Ω–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å —ç–Ω–µ—Ä–≥–∏–∏ –¥–≤–∞–∂–¥—ã

**–®–∞–≥–∏:**

#### –®–∞–≥ 1: –ó–∞–ø–∏—Å–∞—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
```
–ë–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —É—Ä–æ–∫–∞: ___ —ç–Ω–µ—Ä–≥–∏–π
```

#### –®–∞–≥ 2: –ü–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–æ–π—Ç–∏ —Ç–æ—Ç –∂–µ —É—Ä–æ–∫
1. –û—Ç–∫—Ä—ã—Ç—å —Ç–æ—Ç –∂–µ —É—Ä–æ–∫ –µ—â—ë —Ä–∞–∑
2. –î–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ –∫–æ–Ω—Ü–∞
3. –ù–∞–∂–∞—Ç—å "–ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫"

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å
1. –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥–∏"
2. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–ë–∞–ª–∞–Ω—Å –ù–ï –∏–∑–º–µ–Ω–∏–ª—Å—è (–æ—Å—Ç–∞–ª—Å—è —Ç–∞–∫–∏–º –∂–µ)
```

‚úÖ / ‚ùå

#### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ Render.com
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å:
[Energies] User XXX already received award for lesson YYY
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

### –¢–µ—Å—Ç 15: –ù–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–∫–æ–≤ –ø–æ–¥—Ä—è–¥

**–®–∞–≥–∏:**
1. –ü—Ä–æ–π—Ç–∏ 3 —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–∫–∞ –ø–æ–¥—Ä—è–¥
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å: –¥–æ–ª–∂–µ–Ω —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è –Ω–∞ 60 (3 √ó 20)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 3 –Ω–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ +60 —ç–Ω–µ—Ä–≥–∏–π
- ‚úÖ 3 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏

---

### –¢–µ—Å—Ç 16: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö

**–®–∞–≥–∏:**
1. –ó–∞–π—Ç–∏ –ø–æ–¥ –¥—Ä—É–≥–∏–º Telegram –∞–∫–∫–∞—É–Ω—Ç–æ–º
2. –ü—Ä–æ–π—Ç–∏ —Ç–æ—Ç –∂–µ —É—Ä–æ–∫
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞—á–∏—Å–ª–µ–Ω—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç +20 –∑–∞ —Å–≤–æ–π —É—Ä–æ–∫
- ‚úÖ –ë–∞–ª–∞–Ω—Å –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

---

### –¢–µ—Å—Ç 17: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –ø–ª–æ—Ö–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ

**–®–∞–≥–∏:**
1. –í–∫–ª—é—á–∏—Ç—å DevTools ‚Üí Network ‚Üí Throttling ‚Üí Slow 3G
2. –ü—Ä–æ–π—Ç–∏ —É—Ä–æ–∫
3. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –≠–Ω–µ—Ä–≥–∏–∏ –Ω–∞—á–∏—Å–ª–µ–Ω—ã (–≤–æ–∑–º–æ–∂–Ω–æ, —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π)
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

---

### –¢–µ—Å—Ç 18: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ API

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ—à–∏–±–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —É—Ä–æ–∫–∞

**–ò–º–∏—Ç–∞—Ü–∏—è –æ—à–∏–±–∫–∏:**
```bash
# –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backend (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∞!)
# –ò–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –≤ DevTools
```

**–®–∞–≥–∏:**
1. –ü—Ä–æ–π—Ç–∏ —É—Ä–æ–∫ –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–º backend
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É—Ä–æ–∫ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –£—Ä–æ–∫ –∑–∞—Å—á–∏—Ç–∞–Ω
- ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è
- ‚úÖ –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è backend —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞—á–∏—Å–ª–µ–Ω—ã

---

## –ß–µ–∫–ª–∏—Å—Ç –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

### ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ (5 –º–∏–Ω—É—Ç)

- [ ] 1. –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥–∏" ‚Üí –±–∞–ª–∞–Ω—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] 2. –ù–∞–∂–∞—Ç—å "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π" ‚Üí –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ
- [ ] 3. –ò—Å—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] 4. –ü—Ä–æ–π—Ç–∏ –Ω–æ–≤—ã–π —É—Ä–æ–∫ ‚Üí –±–∞–ª–∞–Ω—Å —É–≤–µ–ª–∏—á–∏–ª—Å—è –Ω–∞ +20
- [ ] 5. –ù–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ—è–≤–∏–ª–∞—Å—å –≤ –∏—Å—Ç–æ—Ä–∏–∏

### ‚úÖ –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ (20 –º–∏–Ω—É—Ç)

- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã 1-18 –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] SQL –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ backend
- [ ] –°–∫—Ä–∏–Ω—à–æ—Ç—ã —Å–¥–µ–ª–∞–Ω—ã

---

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –¥–µ–±–∞–≥–∞

### 1. Chrome DevTools

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network:**
```
DevTools ‚Üí Network ‚Üí –§–∏–ª—å—Ç—Ä: "energies"
–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å—ã:
- GET /api/v1/energies/balance
- GET /api/v1/energies/history
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Console:**
```
–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ —Ç–∏–ø–∞:
‚ùå TypeError
‚ùå 500 Internal Server Error
‚ùå undefined is not an object
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å React Components:**
```
DevTools ‚Üí Components ‚Üí –ù–∞–π—Ç–∏:
- RatingsTab
- EnergyHistoryModal
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å props –∏ state
```

---

### 2. Postman Collection

–°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤:

```json
{
  "name": "Energy System Tests",
  "requests": [
    {
      "name": "Get Balance",
      "method": "GET",
      "url": "{{BASE_URL}}/api/v1/energies/balance",
      "headers": {
        "Authorization": "Bearer {{JWT_TOKEN}}"
      }
    },
    {
      "name": "Get History",
      "method": "GET",
      "url": "{{BASE_URL}}/api/v1/energies/history?limit=20",
      "headers": {
        "Authorization": "Bearer {{JWT_TOKEN}}"
      }
    }
  ]
}
```

---

### 3. SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `test_queries.sql`:**

```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞ —É—Ä–æ–∫
SELECT 
  COUNT(*) as lesson_awards_count
FROM energy_transactions
WHERE reason = '–ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞';

-- 2. –¢–æ–ø-10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —ç–Ω–µ—Ä–≥–∏—è–º
SELECT 
  user_id,
  SUM(CASE WHEN type = 'income' THEN amount ELSE -amount END) as balance
FROM energy_transactions
WHERE is_expired = false
GROUP BY user_id
ORDER BY balance DESC
LIMIT 10;

-- 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
SELECT 
  id,
  user_id,
  amount,
  reason,
  metadata->>'lessonId' as lesson_id,
  created_at
FROM energy_transactions
ORDER BY created_at DESC
LIMIT 20;
```

---

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ—à—ë–ª?

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–ª–∞–Ω—Å –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. Backend —Ä–∞–±–æ—Ç–∞–µ—Ç: `curl https://app.successkod.com/health`
2. –≠–Ω–¥–ø–æ–∏–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ Postman
3. JWT —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ DevTools ‚Üí Application ‚Üí Local Storage
4. –í –ë–î –µ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∑–∞–ø—Ä–æ—Å

**–õ–æ–≥ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
```bash
# Backend –ª–æ–≥–∏ (Render.com)
–ò—Å–∫–∞—Ç—å —Å—Ç—Ä–æ–∫–∏:
- [Energies] Awarding 20 points to user XXX
- [Energies] User XXX already received award
- Error –ø—Ä–∏ –≤—ã–∑–æ–≤–µ energiesService
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ò—Å—Ç–æ—Ä–∏—è –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è / –ª–∞–≥–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –í–µ—Ä—Å–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `EnergyHistoryModal.tsx` (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª)
2. CSS –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `globals.css`
3. –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
4. Performance –ø—Ä–æ—Ñ–∏–ª—å (DevTools ‚Üí Performance)

**–ë—ã—Å—Ç—Ä—ã–π —Ñ–∏–∫—Å:**
```bash
# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Ctrl+Shift+R)
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∑–∞ –æ–¥–∏–Ω —É—Ä–æ–∫

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –õ–æ–≥–∏–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ `service.ts`
2. SQL –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã (–¢–µ—Å—Ç 10)
3. –õ–æ–≥–∏ backend - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "already received award"

**–ï—Å–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –µ—Å—Ç—å:**
```sql
-- –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã (–û–°–¢–û–†–û–ñ–ù–û!)
DELETE FROM energy_transactions
WHERE id NOT IN (
  SELECT MIN(id)
  FROM energy_transactions
  GROUP BY user_id, metadata->>'lessonId'
);
```

---

## –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã 1-18 –ø—Ä–æ–π–¥–µ–Ω—ã ‚úÖ
- [ ] SQL –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚úÖ
- [ ] –ù–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –ë–î ‚úÖ
- [ ] –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –ª–∞–≥–æ–≤ ‚úÖ
- [ ] –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚úÖ
- [ ] –ë–∞–ª–∞–Ω—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏ ‚úÖ
- [ ] –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö backend ‚úÖ
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ ‚úÖ
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ iOS –∏ Android ‚úÖ

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏

**GitHub Issues:**
https://github.com/DaniilLepekhin/Hranitel-MiniApp/issues

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- Backend API: `/backend/README.md`
- Frontend: `/webapp/README.md`
- Gamification: `/GAMIFICATION_FIX_REPORT.md`

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –ö–æ–º–º–∏—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| 2026-02-11 | `c5b5b44` | –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞ —É—Ä–æ–∫–∏ |
| 2026-02-11 | `8e99efd` | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã API —Å–∏–≥–Ω–∞—Ç—É—Ä—ã |
| 2026-02-11 | `ae7767e` | –î–æ–±–∞–≤–ª–µ–Ω–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ |
| 2026-02-11 | `988bbf6` | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ undefined transactions |
| 2026-02-11 | `538a930` | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö |
| 2026-02-11 | `e24e2a4` | –ì–ª—É–±–æ–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 11 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Ready for Production Testing
