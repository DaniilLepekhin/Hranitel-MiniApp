# üìù –ú–∏–≥—Ä–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É

## –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

–í —Ç–∞–±–ª–∏—Ü—É `payment_analytics` –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è:
- `name` - –∏–º—è –∏–∑ —Ñ–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã
- `email` - email –∏–∑ —Ñ–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã
- `phone` - —Ç–µ–ª–µ—Ñ–æ–Ω –∏–∑ —Ñ–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—á–µ—Ä–µ–∑ GitHub Actions)
–ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
ssh root@2.58.98.41
cd /var/www/hranitel/backend
bun run migrate
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ù–∞–ø—Ä—è–º—É—é –≤ –ë–î
```bash
ssh root@2.58.98.41
psql -h 31.128.36.81 -U postgres -d club_hranitel -p 5423 -W
```

–ü–∞—Ä–æ–ª—å: `kH*kyrS&9z7K`

–ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
```sql
ALTER TABLE "payment_analytics" ADD COLUMN "name" TEXT;
ALTER TABLE "payment_analytics" ADD COLUMN "email" TEXT;
ALTER TABLE "payment_analytics" ADD COLUMN "phone" TEXT;
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞:

```sql
\d payment_analytics
```

–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ –ø–æ–ª—è: `name`, `email`, `phone`

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∫–æ–¥–µ:

### 1. Schema (`backend/src/db/schema.ts`)
```typescript
// Contact data (–∏–∑ —Ñ–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã)
name: text('name'),
email: text('email'),
phone: text('phone'),
```

### 2. API (`backend/src/modules/analytics/index.ts`)
–¢–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
- `POST /api/analytics/form-open` - name, email, phone (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `POST /api/analytics/payment-attempt` - name, email, phone (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 3. –§–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã (`webapp/public/payment_form_club.html`)
–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ `payment-attempt` —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞—ë—Ç:
```javascript
{
  telegram_id: "...",
  payment_method: "RUB",
  amount: "2000",
  currency: "RUB",
  name: "–ò–º—è –§–∞–º–∏–ª–∏—è",    // ‚≠ê –Ω–æ–≤–æ–µ
  email: "user@mail.com",  // ‚≠ê –Ω–æ–≤–æ–µ
  phone: "+79991234567",   // ‚≠ê –Ω–æ–≤–æ–µ
  ...params
}
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç:

–¢–µ–ø–µ—Ä—å –≤ `payment_analytics` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤—Å–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏:
- –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã
- –ü–æ–ø—ã—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã
- –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚úÖ –í–∏–¥–µ—Ç—å –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ –≤–æ—Ä–æ–Ω–∫–∏
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ª–∏–¥–æ–≤ –ø–æ –º–µ—Ç–∫–∞–º
- ‚úÖ –°—Ç—Ä–æ–∏—Ç—å –æ—Ç—á—ë—Ç—ã –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–º –¥–∞–Ω–Ω—ã–º
